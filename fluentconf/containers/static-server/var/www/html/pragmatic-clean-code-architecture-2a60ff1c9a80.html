<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns:cc="http://creativecommons.org/ns#">
  <head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# medium-com: http://ogp.me/ns/fb/medium-com#">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Pragmatic Clean Code Architecture — The Entity Layer — The linkedcare Engineering team — Medium</title>
        <link rel="canonical" href="https://medium.com/the-engineering-team/pragmatic-clean-code-architecture-2a60ff1c9a80">
          <meta name="title" content="Pragmatic Clean Code Architecture — The Entity Layer — The linkedcare Engineering team">
            <meta name="referrer" content="always">
              <meta name="description" content="Part 2 of the series">
                <meta property="og:site_name" content="Medium">
                  <meta property="og:title" content="Pragmatic Clean Code Architecture — The Entity Layer — The linkedcare Engineering team">
                    <meta property="og:url" content="https://medium.com/the-engineering-team/pragmatic-clean-code-architecture-2a60ff1c9a80">
                      <meta property="og:image" content="https://cdn-images-1.medium.com/max/800/1*FoNtYNwIR_iVZr67iIq_4Q.jpeg">
                        <meta property="fb:app_id" content="542599432471018">
                          <meta property="og:description" content="Part 2 of the series">
                            <meta name="twitter:site" content="@Medium">
                              <meta name="twitter:image:src" content="https://cdn-images-1.medium.com/max/800/1*FoNtYNwIR_iVZr67iIq_4Q.jpeg">
                                <link rel="publisher" href="https://plus.google.com/103654360130207659246">
                                  <link rel="author" href="https://medium.com/@joaquimadraz">
                                    <meta name="author" content="Joaquim Adráz">
                                      <meta property="og:type" content="article">
                                        <meta name="twitter:card" content="summary_large_image">
                                          <meta property="article:publisher" content="https://www.facebook.com/medium">
                                            <meta property="article:author" content="https://medium.com/@joaquimadraz">
                                              <meta property="fb:smart_publish:robots" content="noauto">
                                                <meta property="article:published_time" content="2015-08-25T15:05:01.474Z">
                                                  <meta name="twitter:creator" content="@joaquimadraz">
                                                    <meta name="twitter:app:name:iphone" content="Medium">
                                                      <meta name="twitter:app:id:iphone" content="828256236">
                                                        <meta name="twitter:app:url:iphone" content="medium:/p/2a60ff1c9a80">
                                                          <meta property="al:ios:app_name" content="Medium">
                                                            <meta property="al:ios:app_store_id" content="828256236">
                                                              <meta property="al:android:package" content="com.medium.reader">
                                                                <meta property="al:android:app_name" content="Medium">
                                                                  <meta property="al:ios:url" content="medium:/p/2a60ff1c9a80">
                                                                    <meta property="al:android:url" content="medium://p/2a60ff1c9a80">
                                                                      <meta property="al:web:url" content="https://medium.com/the-engineering-team/pragmatic-clean-code-architecture-2a60ff1c9a80">
                                                                        <link rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/2a60ff1c9a80" />
                                                                        <meta name="theme-color" content="#000000">
                                                                          <link rel="stylesheet" href="https://cdn-static-1.medium.com/_/fp/css/main-base.VzyPz4jos5FyyiYfuOx6fQ.css">
                                                                            <!--.-->
                                                                            <!--.-->
                                                                            <!--[if lt IE 9]>
                                                                            <!--.--><![endif]-->
                                                                            <link rel="shortcut icon" href="https://cdn-static-1.medium.com/_/fp/icons/favicon-new.TAS6uQ-Y7kcKgi0xjcYHXw.ico">
                                                                              <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-ipad-retina.png">
                                                                                <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-iphone-retina.png">
                                                                                  <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-ipad.png">
                                                                                    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
                                                                                    </head>
                                                                                    <body itemscope itemtype="http://schema.org/Article" class=" template-flex-article is-noJs">
                                                                                      <!--.-->
                                                                                      <div class="site-main" id="container">
                                                                                        <div class="butterBar butterBar--error">
                                                                                        </div>
                                                                                        <div class="surface">
                                                                                          <div id="prerendered" class="screenContent">
                                                                                            <canvas class="canvas-renderer">
                                                                                            </canvas>
                                                                                            <nav class="metabar u-clearfix js-metabar metabar--top metabar--postArticle">
                                                                                              <div class="metabar-block metabar-left u-floatLeft">
                                                                                                <a href="https://medium.com/" class="siteNav-logo" data-log-event="home">
                                                                                                  <svg viewBox="0 0 45 45" width="45" height="45" class="svgIcon svgIcon--logoNew svgIcon-size--45px">
                                                                                                    <use class="svgIcon-use svgIcon-use--part0" xlink:href="#svg-logoNew-45px-p0">
                                                                                                    </use>
                                                                                                    <use class="svgIcon-use svgIcon-use--part1" xlink:href="#svg-logoNew-45px-p1">
                                                                                                    </use>
                                                                                                    <use class="svgIcon-use svgIcon-use--part2" xlink:href="#svg-logoNew-45px-p2">
                                                                                                    </use>
                                                                                                    <use class="svgIcon-use svgIcon-use--part3" xlink:href="#svg-logoNew-45px-p3">
                                                                                                    </use>
                                                                                                  </svg>
                                                                                                  <span class="u-textScreenReader">Homepage</span>
                                                                                                </a>
                                                                                                <span class="metabar-divider metabar-divider--first u-showOnMobile">
                                                                                                </span>
                                                                                                <span class="postMetaInline postMetaInline--avatar u-showOnMobile">
                                                                                                  <a class="link avatar avatar--roundedRectangle"  href="https://medium.com/the-engineering-team?source=avatarTopMetabar-lo_d9824a27393b-85c1b1b68eb1" title="Go to The linkedcare Engineering team" aria-label="Go to The linkedcare Engineering team" data-action-source="avatarTopMetabar-lo_d9824a27393b-85c1b1b68eb1">
                                                                                                    <img src="https://cdn-images-1.medium.com/fit/c/32/32/1*HzRE96Rjos_PSSmLTwI62A.jpeg" class="avatar-image avatar-image--icon" alt="The linkedcare Engineering team">
                                                                                                    </a>
                                                                                                  </span>
                                                                                                </div>
                                                                                                <div class="metabar-block metabar-center">
                                                                                                  <a class="metabar-logoWrapper js-logCollection" href="https://medium.com/the-engineering-team?source=logo-lo_d9824a27393b-85c1b1b68eb1">
                                                                                                    <img class="metabar-logo" src="https://cdn-images-1.medium.com/fit/c/104/36/1*DZjUBrvyW3vJPNbrBkymhg.jpeg?source=logoAvatar-lo_d9824a27393b-85c1b1b68eb1" alt="Published in The linkedcare Engineering team"/>
                                                                                                  </a>
                                                                                                </div>
                                                                                                <div class="metabar-block metabar-right u-floatRight">
                                                                                                  <div class="buttonSet">
                                                                                                  </div>
                                                                                                  <div class="inputGroup u-xs-hide metabar-predictiveSearch">
                                                                                                    <button class="button button--chromeless button--inline button--withIcon is-inSiteNavBar button--withSvgIcon"  title="Click to start typing a search term" aria-label="Click to start typing a search term" data-action="focus-search-input">
                                                                                                      <svg viewBox="0 0 25 25" width="25" height="25" class="svgIcon svgIcon--search svgIcon-size--25px">
                                                                                                        <use class="svgIcon-use svgIcon-use--part0" xlink:href="#svg-search-25px-p0">
                                                                                                        </use>
                                                                                                      </svg>
                                                                                                    </button>
                                                                                                    <input class="js-predictiveSearchInput textInput textInput--rounded textInput--dark" type="search" placeholder="Search Medium">
                                                                                                    </div>
                                                                                                    <div class="buttonSet">
                                                                                                      <button class="button button--circle button--withChrome button--withIcon is-inSiteNavBar u-showOnMobile button--withSvgIcon"  title="Search" aria-label="Search" data-action="open-search">
                                                                                                        <svg viewBox="0 0 25 25" width="25" height="25" class="svgIcon svgIcon--search svgIcon-size--25px">
                                                                                                          <use class="svgIcon-use svgIcon-use--part0" xlink:href="#svg-search-25px-p0">
                                                                                                          </use>
                                                                                                        </svg>
                                                                                                      </button>
                                                                                                      <a class="button button--primary button--withChrome"  href="https://medium.com/m/signin?redirect=https%3A%2F%2Fmedium.com%3A443%2Fthe-engineering-team%2Fpragmatic-clean-code-architecture-2a60ff1c9a80"data-action="sign-in-prompt"data-redirect="https://medium.com:443/the-engineering-team/pragmatic-clean-code-architecture-2a60ff1c9a80" data-action-source="nav_signup">Sign in / Sign up</a>
                                                                                                    </div>
                                                                                                  </div>
                                                                                                </nav>
                                                                                                <div class="postActionsBar js-postActionsBar">
                                                                                                  <div class="postActionsBar-container container u-size740">
                                                                                                    <div class="postActionsBar-content row js-postActionsBarContent">
                                                                                                      <div class="postActions col u-xs-size12of12">
                                                                                                        <div class="u-floatLeft buttonSet buttonSet--withLabels">
                                                                                                          <div class="buttonSet-inner">
                                                                                                            <div class="js-actionRecommend" data-post-id="2a60ff1c9a80" data-size="29px">
                                                                                                              <button class="button button--primary button--large button--chromeless button--withIcon button--withSvgIcon"  title="Recommend to share this article with your followers and let the author know you liked it" aria-label="Recommend to share this article with your followers and let the author know you liked it"data-action="sign-in-prompt" data-sign-in-action="upvote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/2a60ff1c9a80">
                                                                                                                <span class="button-defaultState">
                                                                                                                  <svg viewBox="0 0 29 29" width="29" height="29" class="svgIcon svgIcon--heart svgIcon-size--29px">
                                                                                                                    <use class="svgIcon-use svgIcon-use--part0" xlink:href="#svg-heart-29px-p0">
                                                                                                                    </use>
                                                                                                                  </svg>
                                                                                                                </span>
                                                                                                                <span class="button-activeState">
                                                                                                                  <svg viewBox="0 0 29 29" width="29" height="29" class="svgIcon svgIcon--heartFilled svgIcon-size--29px">
                                                                                                                    <use class="svgIcon-use svgIcon-use--part0" xlink:href="#svg-heartFilled-29px-p0">
                                                                                                                    </use>
                                                                                                                  </svg>
                                                                                                                </span>
                                                                                                              </button>
                                                                                                              <button class="button button--chromeless"  data-action="show-recommends" data-action-value="2a60ff1c9a80">7</button>
                                                                                                            </div>
                                                                                                          </div>
                                                                                                          <div class="buttonSet-inner">
                                                                                                            <button class="button button--large button--dark button--chromeless button--withIcon button--withSvgIcon"  data-action="scroll-to-responses">
                                                                                                              <svg viewBox="0 0 29 29" width="29" height="29" class="svgIcon svgIcon--response svgIcon-size--29px">
                                                                                                                <use class="svgIcon-use svgIcon-use--part0" xlink:href="#svg-response-29px-p0">
                                                                                                                </use>
                                                                                                              </svg>
                                                                                                            </button>
                                                                                                            <button class="button button--chromeless"  data-action="scroll-to-responses">1</button>
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div class="u-floatRight buttonSet">
                                                                                                          <div class="buttonSet-inner">
                                                                                                            <button class="button button--large button--dark button--chromeless button--withIcon button--withSvgIcon"  data-action="share-on-twitter"value="2a60ff1c9a80">
                                                                                                              <svg viewBox="0 0 29 29" width="29" height="29" class="svgIcon svgIcon--twitter svgIcon-size--29px">
                                                                                                                <use class="svgIcon-use svgIcon-use--part0" xlink:href="#svg-twitter-29px-p0">
                                                                                                                </use>
                                                                                                              </svg>
                                                                                                            </button>
                                                                                                          </div>
                                                                                                          <div class="buttonSet-inner">
                                                                                                            <button class="button button--large button--dark button--chromeless button--withIcon button--withSvgIcon"  data-action="share-on-facebook"value="2a60ff1c9a80">
                                                                                                              <svg viewBox="0 0 29 29" width="29" height="29" class="svgIcon svgIcon--facebook svgIcon-size--29px">
                                                                                                                <use class="svgIcon-use svgIcon-use--part0" xlink:href="#svg-facebook-29px-p0">
                                                                                                                </use>
                                                                                                              </svg>
                                                                                                            </button>
                                                                                                          </div>
                                                                                                          <div class="buttonSet-separator">
                                                                                                          </div>
                                                                                                          <div class="buttonSet-inner">
                                                                                                            <a class="link avatar avatar--inline"  href="https://medium.com/@joaquimadraz" data-action="show-user-card" data-action-type="hover" data-user-id="de4ec8fdb6c4" dir="auto">
                                                                                                              <img src="https://cdn-images-1.medium.com/fit/c/24/24/1*S4fZT4hlC9umSNsb40WP4g.jpeg" class="avatar-image avatar-image--micro" alt="Go to the profile of Joaquim Adráz">
                                                                                                                <span class="avatar-text">Joaquim Adráz</span>
                                                                                                              </a>
                                                                                                              <span class="u-xs-hide">
                                                                                                                <span class="middotDivider">
                                                                                                                </span>
                                                                                                                <span class="followState js-followState" data-user-id="de4ec8fdb6c4">
                                                                                                                  <button class="button button--chromeless u-noUserSelect button--withHover button--unblock js-unblockButton" data-action="sign-in-prompt" data-sign-in-action="toggle-block-user" data-requires-token="true" data-action-source="post_actions_bar">
                                                                                                                    <span class="button-label  button-defaultState">Blocked</span>
                                                                                                                    <span class="button-label button-hoverState">Unblock</span>
                                                                                                                  </button>
                                                                                                                  <button class="button button--primary button--chromeless u-noUserSelect button--follow js-followButton"  title="Follow to get new stories and recommendations from this author" aria-label="Follow to get new stories and recommendations from this author"data-action="sign-in-prompt" data-sign-in-action="toggle-subscribe-user" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/user/de4ec8fdb6c4/2a60ff1c9a80" data-action-source="post_actions_bar_follow">
                                                                                                                    <span class="button-label  button-defaultState js-buttonLabel">Follow</span>
                                                                                                                    <span class="button-label button-activeState">Following</span>
                                                                                                                  </button>
                                                                                                                </span>
                                                                                                              </span>
                                                                                                            </div>
                                                                                                          </div>
                                                                                                        </div>
                                                                                                      </div>
                                                                                                    </div>
                                                                                                  </div>
                                                                                                  <article class="u-sizeViewHeightMin100 postArticle postArticle--full" lang="en">
                                                                                                    <header class="container is-underMetabar u-size740">
                                                                                                      <div class="postMetaHeader row u-xs-top10 u-xs-bottom10">
                                                                                                        <div class="col u-xs-size5of12">
                                                                                                          <div class="u-floatLeft">
                                                                                                            <div class="postMetaInline-avatar">
                                                                                                              <a class="link avatar"  href="https://medium.com/@joaquimadraz" data-action="show-user-card" data-action-type="hover" data-user-id="de4ec8fdb6c4" dir="auto">
                                                                                                                <img src="https://cdn-images-1.medium.com/fit/c/36/36/1*S4fZT4hlC9umSNsb40WP4g.jpeg" class="avatar-image u-xs-size32x32 u-sm-size36x36" alt="Go to the profile of Joaquim Adráz">
                                                                                                                </a>
                                                                                                              </div>
                                                                                                              <div class="postMetaInline-feedSummary">
                                                                                                                <a class="link link link--darken link--accent"  href="https://medium.com/@joaquimadraz" data-action="show-user-card" data-action-type="hover" data-user-id="de4ec8fdb6c4" dir="auto">Joaquim Adráz</a>
                                                                                                                <span class="postMetaInline postMetaInline--supplemental">Aug 25<span class="middotDivider">
                                                                                                                </span>
                                                                                                                <span class="readingTime">4 min read</span>
                                                                                                              </span>
                                                                                                            </div>
                                                                                                          </div>
                                                                                                        </div>
                                                                                                        <div class="col u-xs-size7of12">
                                                                                                          <div class="u-floatRight">
                                                                                                            <div class="postMetaHeader-socialProof">
                                                                                                            </div>
                                                                                                          </div>
                                                                                                        </div>
                                                                                                      </div>
                                                                                                    </header>
                                                                                                    <main role="main" class="postArticle-content js-postField js-notesSource">
                                                                                                      <section name="60f1" class=" section--body section--middleCenter section-image--aspectRatioViewport is-imageBackgrounded is-backgrounded is-darkBackgrounded section--first is-aboveSectionCaption">
                                                                                                        <div class="section-background" data-scroll="aspect-ratio-viewport"contenteditable="false" data-image-id="1*FoNtYNwIR_iVZr67iIq_4Q.jpeg" data-width="4738" data-height="2898">
                                                                                                          <div class="section-backgroundImage"style="background-image: url(https://cdn-images-1.medium.com/max/1200/1*FoNtYNwIR_iVZr67iIq_4Q.jpeg);">
                                                                                                          </div>
                                                                                                          <br>
                                                                                                          </div>
                                                                                                          <div class="section-doubleWidthTable u-table u-ignoreBlock">
                                                                                                            <div class="u-tableCell u-verticalAlignTop u-ignoreBlock">
                                                                                                              <div class="section-aspectRatioViewportBottomSpacer u-ignoreBlock">
                                                                                                                <div class="u-ignoreBlock" style="padding-bottom: 30.5825%;">
                                                                                                                </div>
                                                                                                              </div>
                                                                                                              <div class="section-doubleWidthTable u-table u-ignoreBlock">
                                                                                                                <div class="section-contentCell u-tableCell u-ignoreBlock">
                                                                                                                  <div class="section-content">
                                                                                                                    <div class="section-inner layoutSingleColumn">
                                                                                                                      <h2 name="5087" id="5087" class="graf--h2 graf--first">Pragmatic Clean Code Architecture</h2>
                                                                                                                      <h4 name="27f4" id="27f4" class="graf--h4 graf-after--h2">The Entity Layer</h4>
                                                                                                                    </div>
                                                                                                                  </div>
                                                                                                                </div>
                                                                                                                <div class="u-tableCell u-verticalAlignTop u-ignoreBlock">
                                                                                                                  <div class="section-aspectRatioViewportPlaceholder u-ignoreBlock">
                                                                                                                    <div class="u-ignoreBlock" style="padding-bottom: 61.165%;">
                                                                                                                    </div>
                                                                                                                  </div>
                                                                                                                  <div class="section-aspectRatioViewportBottomPlaceholder u-ignoreBlock">
                                                                                                                    <div class="u-ignoreBlock" style="padding-bottom: 30.5825%;">
                                                                                                                    </div>
                                                                                                                  </div>
                                                                                                                </div>
                                                                                                              </div>
                                                                                                            </div>
                                                                                                            <div class="u-tableCell u-ignoreBlock">
                                                                                                              <div class="section-aspectRatioViewportCropPlaceholder u-ignoreBlock">
                                                                                                                <div class="u-ignoreBlock" style="padding-bottom: 61.165%;">
                                                                                                                </div>
                                                                                                              </div>
                                                                                                            </div>
                                                                                                          </div>
                                                                                                          <div class="section-captionContent u-ignoreBlock">
                                                                                                            <div class="section-inner sectionLayout--caption">
                                                                                                              <label name="c059" id="c059" data-default-value="Type caption for image (optional)" class="graf--sectionCaption graf-after--h4 graf--last">Portuguese Sidewalk aka “Calçada Portuguesa”</label>
                                                                                                            </div>
                                                                                                          </div>
                                                                                                        </section>
                                                                                                        <section name="5bb4" class=" section--body">
                                                                                                          <div class="section-divider layoutSingleColumn">
                                                                                                            <hr class="section-divider">
                                                                                                            </div>
                                                                                                            <div class="section-content">
                                                                                                              <div class="section-inner layoutSingleColumn">
                                                                                                                <p name="df7d" id="df7d" data-align="center" class="graf--p graf--first">[ <a href="https://medium.com/the-engineering-team/pragmatic-clean-code-architecture-d0d34f38849a" data-href="https://medium.com/the-engineering-team/pragmatic-clean-code-architecture-d0d34f38849a" class="markup--anchor markup--p-anchor">part 1</a> | part 2]</p>
                                                                                                                <p name="20e0" id="20e0" class="graf--p graf-after--p">In the previous <a href="https://medium.com/the-engineering-team/pragmatic-clean-code-architecture-d0d34f38849a" data-href="https://medium.com/the-engineering-team/pragmatic-clean-code-architecture-d0d34f38849a" class="markup--anchor markup--p-anchor">post of the series,</a> I’ve talked about The Use Case Layer of Clean Code Architecture. I’ve shown how we, at <a href="http://www.linkedcare.com/en/index.html" data-href="http://www.linkedcare.com/en/index.html" class="markup--anchor markup--p-anchor" rel="nofollow">linkedcare</a>, are structuring our business logic code and how it’s helping us keep the code that matters in a place that is decoupled from everything that goes around our applications and micro services. Give it a look, you will better understand how our Use Cases look like.</p>
                                                                                                                <p name="6d86" id="6d86" class="graf--p graf-after--p">In this post I will talk about the <strong class="markup--strong markup--p-strong">Entity Layer</strong> and how we managed to create a balance between the theory and what is more practical for our everyday coding needs.</p>
                                                                                                                <figure name="f91e" id="f91e" class="graf--figure graf-after--p">
                                                                                                                  <div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 514px;">
                                                                                                                    <div class="aspect-ratio-fill" style="padding-bottom: 73.4%;">
                                                                                                                    </div>
                                                                                                                    <img class="graf-image" data-image-id="1*JdxbwP49ZwqBMxgmxwExDw.jpeg" data-width="772" data-height="567" data-action="zoom" data-action-value="1*JdxbwP49ZwqBMxgmxwExDw.jpeg" src="https://cdn-images-1.medium.com/max/800/1*JdxbwP49ZwqBMxgmxwExDw.jpeg">
                                                                                                                    </div>
                                                                                                                    <figcaption class="imageCaption">Image fromUncle Bob’s<a href="http://blog.8thlight.com/" data-href="http://blog.8thlight.com/" class="markup--anchor markup--figure-anchor" rel="nofollow">C</a>lean Code Arquitecture Blog Post — <a href="http://blog.8thlight.com/uncle-bob/2012/08/13/the-clean-architecture.html" data-href="http://blog.8thlight.com/uncle-bob/2012/08/13/the-clean-architecture.html" class="markup--anchor markup--figure-anchor" rel="nofollow">http://blog.8thlight.com/uncle-bob/2012/08/13/the-clean-architecture.htm</a>
                                                                                                                  </figcaption>
                                                                                                                </figure>
                                                                                                                <p name="14cb" id="14cb" class="graf--p graf-after--figure">First things first. Uncle Bob’s Clean Code Architecture (CCA) tells us that an Entity is a representation of data of our domain, it’s so dumb that we are only giving the possibility to represent it self in a different way. No database access, nor business logic, only data.</p>
                                                                                                                <p name="8838" id="8838" class="graf--p graf-after--p">In our apps Models are a key component so, migrating our Models to CCA Entities was, and still is, a really hard process. Also we use ActiveRecord a lot in our Models, which provides us with a straight forward ORM and some other goodies that we can’t just leave behind, at least for now. But we had to make some compromises and <em class="markup--em markup--p-em">Pragmatic Entities</em> are the result of those compromises.</p>
                                                                                                                <h3 name="d3da" id="d3da" class="graf--h3 graf-after--p">Pragmatic Entities</h3>
                                                                                                                <p name="bc29" id="bc29" class="graf--p graf-after--h3">For us, a Pragmatic Entity is still an ActiveRecord Model that is used to CRUD data from the database and represent it inside our business logic.</p>
                                                                                                                <p name="3a14" id="3a14" class="graf--p graf-after--p graf--last">As I said before, there are limits to use ActiveRecord Models. The main idea is: <strong class="markup--strong markup--p-strong">There’s no business logic inside a Model<em class="markup--em markup--p-em">. </em>
                                                                                                                </strong>This has implications, mainly for Callbacks and Validations, as I will explain now.</p>
                                                                                                              </div>
                                                                                                            </div>
                                                                                                          </section>
                                                                                                          <section name="3bcc" class=" section--body">
                                                                                                            <div class="section-divider layoutSingleColumn">
                                                                                                              <hr class="section-divider">
                                                                                                              </div>
                                                                                                              <div class="section-content">
                                                                                                                <div class="section-inner layoutSingleColumn">
                                                                                                                  <p name="5410" id="5410" class="graf--p graf--first">
                                                                                                                    <strong class="markup--strong markup--p-strong">
                                                                                                                      <em class="markup--em markup--p-em">Note: </em>
                                                                                                                    </strong>
                                                                                                                    <em class="markup--em markup--p-em">In our micro services, most of the times we have two kinds of validations: API Validations and Use Case Validations. API Validations are used to ensure that you send all the required data with right types to the endpoint, when it fails the server replies with a 400 bad request.</em>
                                                                                                                  </p>
                                                                                                                  <p name="1d94" id="1d94" class="graf--p graf-after--p">
                                                                                                                    <em class="markup--em markup--p-em">Use Case Validations ensure that the data you send has the right value to execute the Use Case. Normally, if these fails, the endpoint returns 422 Unprocessable Entity or 409 Conflict.</em>
                                                                                                                  </p>
                                                                                                                  <figure name="299f" id="299f" class="graf--figure graf--iframe graf-after--p graf--last">
                                                                                                                    <div class="iframeContainer">
                                                                                                                      <iframe width="700" height="250" src="/media/cff442327c9abd683f89d3b2a45a7ddd?maxWidth=700" data-media-id="cff442327c9abd683f89d3b2a45a7ddd" frameborder="0">
                                                                                                                      </iframe>
                                                                                                                    </div>
                                                                                                                  </figure>
                                                                                                                </div>
                                                                                                              </div>
                                                                                                            </section>
                                                                                                            <section name="a45a" class=" section--body">
                                                                                                              <div class="section-divider layoutSingleColumn">
                                                                                                                <hr class="section-divider">
                                                                                                                </div>
                                                                                                                <div class="section-content">
                                                                                                                  <div class="section-inner layoutSingleColumn">
                                                                                                                    <p name="5a3e" id="5a3e" class="graf--p graf--first">ActiveRecord callbacks normally have some kind of business logic. Sometimes you need to transform a value, others you need to send an email… please don’t. Callbacks are part of a particular Use Case, for instance, if you need to create a token for a <em class="markup--em markup--p-em">User</em> before create, that’s responsibility of the <em class="markup--em markup--p-em">User::Create</em> Use Case.</p>
                                                                                                                    <p name="8c46" id="8c46" class="graf--p graf-after--p">How many of you have a User model like this (or worse)? We all know where this class is heading.</p>
                                                                                                                    <figure name="a94c" id="a94c" class="graf--figure graf--iframe graf-after--p">
                                                                                                                      <div class="iframeContainer">
                                                                                                                        <iframe width="700" height="250" src="/media/e191060052b06ac70667cbbcecba9373?maxWidth=700" data-media-id="e191060052b06ac70667cbbcecba9373" frameborder="0">
                                                                                                                        </iframe>
                                                                                                                      </div>
                                                                                                                    </figure>
                                                                                                                    <p name="24c4" id="24c4" class="graf--p graf-after--figure">ActiveRecord validations are awesome, but they are not part of a Pragmatic Entity. You only know what kind of validations you want to do, when you’re working with an Entity in a certain context. It’s the same idea from callbacks, if you need to validate a <em class="markup--em markup--p-em">User </em>before create, your run the <em class="markup--em markup--p-em">User::Validate </em>Use Case<em class="markup--em markup--p-em">
                                                                                                                      </em>before calling <em class="markup--em markup--p-em">User::Create.</em>
                                                                                                                    </p>
                                                                                                                    <p name="678e" id="678e" class="graf--p graf-after--p">Even after extracting all the business logic, validations and callbacks to Use Cases, there’re still S<em class="markup--em markup--p-em">copes, Associations </em>and the main ORM API to query and interact with the database. Methods like .<em class="markup--em markup--p-em">create</em>, <em class="markup--em markup--p-em">.find</em>, <em class="markup--em markup--p-em">.update_attributes</em>, will be around our code base using ActiveRecord or other kind of persistence implementation. So, as a common interface that it is, is part of a Pragmatic Entity, just like <em class="markup--em markup--p-em">Scopes</em> and <em class="markup--em markup--p-em">Associations.</em>
                                                                                                                  </p>
                                                                                                                  <p name="728c" id="728c" class="graf--p graf-after--p">This is the business logic extracted from the model:</p>
                                                                                                                  <figure name="7aaa" id="7aaa" class="graf--figure graf--iframe graf-after--p">
                                                                                                                    <div class="iframeContainer">
                                                                                                                      <iframe width="700" height="250" src="/media/2edf8d2edf8b4b811207d24acdf794a8?maxWidth=700" data-media-id="2edf8d2edf8b4b811207d24acdf794a8" frameborder="0">
                                                                                                                      </iframe>
                                                                                                                    </div>
                                                                                                                  </figure>
                                                                                                                  <p name="a8ad" id="a8ad" data-align="center" class="graf--p graf-after--figure">
                                                                                                                    <em class="markup--em markup--p-em">This time I’ve used the </em>
                                                                                                                    <a href="https://github.com/goncalvesjoao/rest_my_case" data-href="https://github.com/goncalvesjoao/rest_my_case" class="markup--anchor markup--p-anchor" rel="nofollow">
                                                                                                                      <em class="markup--em markup--p-em">RestMyCase</em>
                                                                                                                    </a>
                                                                                                                    <em class="markup--em markup--p-em"> gem from </em>
                                                                                                                    <a href="https://github.com/goncalvesjoao" data-href="https://github.com/goncalvesjoao" class="markup--anchor markup--p-anchor" rel="nofollow">
                                                                                                                      <em class="markup--em markup--p-em">@goncalvesjoao</em>
                                                                                                                    </a>
                                                                                                                    <em class="markup--em markup--p-em"> for this example.</em>
                                                                                                                  </p>
                                                                                                                  <h3 name="4065" id="4065" class="graf--h3 graf-after--p">Wrapping Up</h3>
                                                                                                                  <p name="0d0b" id="0d0b" class="graf--p graf-after--h3">Decoupling database access from Entities is not our main concern right now. We managed to reduce our Entities to a level that we feel comfortable with and we see many advantages of accessing the database from it.<br>Mostly because it gives us coding freedom on a day by day basis.</p>
                                                                                                                  <p name="3270" id="3270" class="graf--p graf-after--p graf--last">The process of decoupling will change the whole persistence layer and we can’t even count the repercussions that that decision will take for our apps. Meanwhile we are creating some POCs implementing the Repository Pattern but we did not found the right way to do it yet.<br>
                                                                                                                    <strong class="markup--strong markup--p-strong">So, if you have any ideia/project, feel free to share it with us.</strong>
                                                                                                                  </p>
                                                                                                                </div>
                                                                                                              </div>
                                                                                                            </section>
                                                                                                            <section name="59ab" class=" section--body section--last">
                                                                                                              <div class="section-divider layoutSingleColumn">
                                                                                                                <hr class="section-divider">
                                                                                                                </div>
                                                                                                                <div class="section-content">
                                                                                                                  <div class="section-inner layoutSingleColumn">
                                                                                                                    <p name="d875" id="d875" class="graf--p graf--first">In the next post I will talk about the <strong class="markup--strong markup--p-strong">Interface Adapters Layer</strong> and how we can connect any framework (Rails, Sinatra or Grape) with the Use Cases and Entities.</p>
                                                                                                                    <p name="b639" id="b639" class="graf--p graf-after--p graf--last">If you have any questions you can reach me via twitter <a href="https://twitter.com/joaquimadraz" data-href="https://twitter.com/joaquimadraz" class="markup--anchor markup--p-anchor" rel="nofollow">
                                                                                                                      <strong class="markup--strong markup--p-strong">@joaquimadraz</strong>
                                                                                                                    </a>
                                                                                                                    <strong class="markup--strong markup--p-strong">!</strong>
                                                                                                                  </p>
                                                                                                                </div>
                                                                                                              </div>
                                                                                                            </section>
                                                                                                          </main>
                                                                                                          <footer class="postArticle-footer">
                                                                                                            <div class="postActionsFooter container u-size740">
                                                                                                              <div class="row">
                                                                                                                <div class="col u-xs-size12of12">
                                                                                                                  <div class="postMeta-inlineAcknowledgments">
                                                                                                                    <span class="postMeta-acknowledgment">
                                                                                                                      <span data-tooltip="The following people helped the author by providing feedback before the story was published.">Thanks to</span>
                                                                                                                      <span>
                                                                                                                        <a class="link"  href="https://medium.com/@cesarmcferreira" data-action="show-user-card" data-action-type="hover" data-user-id="e2014d14afbc" dir="auto">César Ferreira</a>, </span>
                                                                                                                        <span>
                                                                                                                          <a class="link"  href="https://medium.com/@alexmc" data-action="show-user-card" data-action-type="hover" data-user-id="eba2502133b4" dir="auto">Alexandre Carvalho</a>, and </span>
                                                                                                                          <span>
                                                                                                                            <a class="link"  href="https://medium.com/@rramos" data-action="show-user-card" data-action-type="hover" data-user-id="34f609b643c4" dir="auto">RicardoRamos</a>
                                                                                                                            </span>.</span>
                                                                                                                          </div>
                                                                                                                        </div>
                                                                                                                      </div>
                                                                                                                      <div class="row">
                                                                                                                        <div class="col u-xs-size12of12 js-postTags">
                                                                                                                          <div class="postTags">
                                                                                                                            <div class="tags tags--postTags tags--borderless">
                                                                                                                              <a class="link"  href="https://medium.com/tag/software-architecture?source=post" title="Go to Software Architecture" aria-label="Go to Software Architecture" data-action-source="post">Software Architecture</a>
                                                                                                                              <a class="link"  href="https://medium.com/tag/software-development?source=post" title="Go to Software Development" aria-label="Go to Software Development" data-action-source="post">Software Development</a>
                                                                                                                              <a class="link"  href="https://medium.com/tag/ruby?source=post" title="Go to Ruby" aria-label="Go to Ruby" data-action-source="post">Ruby</a>
                                                                                                                            </div>
                                                                                                                          </div>
                                                                                                                        </div>
                                                                                                                      </div>
                                                                                                                      <div class="row js-postActionsFooter">
                                                                                                                        <div class="postActions col u-xs-size12of12">
                                                                                                                          <div class="u-floatLeft buttonSet buttonSet--withLabels">
                                                                                                                            <div class="buttonSet-inner">
                                                                                                                              <div class="js-actionRecommend" data-post-id="2a60ff1c9a80" data-size="29px">
                                                                                                                                <button class="button button--primary button--large button--chromeless button--withIcon button--withSvgIcon"  title="Recommend to share this article with your followers and let the author know you liked it" aria-label="Recommend to share this article with your followers and let the author know you liked it"data-action="sign-in-prompt" data-sign-in-action="upvote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/2a60ff1c9a80">
                                                                                                                                  <span class="button-defaultState">
                                                                                                                                    <svg viewBox="0 0 29 29" width="29" height="29" class="svgIcon svgIcon--heart svgIcon-size--29px">
                                                                                                                                      <use class="svgIcon-use svgIcon-use--part0" xlink:href="#svg-heart-29px-p0">
                                                                                                                                      </use>
                                                                                                                                    </svg>
                                                                                                                                  </span>
                                                                                                                                  <span class="button-activeState">
                                                                                                                                    <svg viewBox="0 0 29 29" width="29" height="29" class="svgIcon svgIcon--heartFilled svgIcon-size--29px">
                                                                                                                                      <use class="svgIcon-use svgIcon-use--part0" xlink:href="#svg-heartFilled-29px-p0">
                                                                                                                                      </use>
                                                                                                                                    </svg>
                                                                                                                                  </span>
                                                                                                                                </button>
                                                                                                                                <button class="button button--chromeless"  data-action="show-recommends" data-action-value="2a60ff1c9a80">7</button>
                                                                                                                              </div>
                                                                                                                            </div>
                                                                                                                            <div class="buttonSet-inner">
                                                                                                                              <button class="button button--large button--dark button--chromeless button--withIcon button--withSvgIcon"  data-action="scroll-to-responses">
                                                                                                                                <svg viewBox="0 0 29 29" width="29" height="29" class="svgIcon svgIcon--response svgIcon-size--29px">
                                                                                                                                  <use class="svgIcon-use svgIcon-use--part0" xlink:href="#svg-response-29px-p0">
                                                                                                                                  </use>
                                                                                                                                </svg>
                                                                                                                              </button>
                                                                                                                              <button class="button button--chromeless"  data-action="scroll-to-responses">1</button>
                                                                                                                            </div>
                                                                                                                          </div>
                                                                                                                          <div class="u-floatRight buttonSet buttonSet--narrow">
                                                                                                                            <button class="button button--large button--dark button--chromeless button--withIcon button--withSvgIcon"  data-action="share-on-twitter"value="2a60ff1c9a80">
                                                                                                                              <svg viewBox="0 0 29 29" width="29" height="29" class="svgIcon svgIcon--twitter svgIcon-size--29px">
                                                                                                                                <use class="svgIcon-use svgIcon-use--part0" xlink:href="#svg-twitter-29px-p0">
                                                                                                                                </use>
                                                                                                                              </svg>
                                                                                                                            </button>
                                                                                                                            <button class="button button--large button--dark button--chromeless button--withIcon button--withSvgIcon"  data-action="share-on-facebook"value="2a60ff1c9a80">
                                                                                                                              <svg viewBox="0 0 29 29" width="29" height="29" class="svgIcon svgIcon--facebook svgIcon-size--29px">
                                                                                                                                <use class="svgIcon-use svgIcon-use--part0" xlink:href="#svg-facebook-29px-p0">
                                                                                                                                </use>
                                                                                                                              </svg>
                                                                                                                            </button>
                                                                                                                            <button class="button button--large button--dark button--chromeless button--withIcon js-moreActionsButton button--withSvgIcon"  title="More actions" aria-label="More actions" data-action="more-actions">
                                                                                                                              <svg viewBox="0 0 25 25" width="25" height="25" class="svgIcon svgIcon--more svgIcon-size--25px">
                                                                                                                                <use class="svgIcon-use svgIcon-use--part0" xlink:href="#svg-more-25px-p0">
                                                                                                                                </use>
                                                                                                                              </svg>
                                                                                                                            </button>
                                                                                                                          </div>
                                                                                                                        </div>
                                                                                                                      </div>
                                                                                                                    </div>
                                                                                                                    <div class="container u-size740">
                                                                                                                      <div class="row postFooter-info2">
                                                                                                                        <div class="col u-xs-size12of12">
                                                                                                                          <hr class="postFooter-infoDivider">
                                                                                                                          </div>
                                                                                                                        </div>
                                                                                                                        <div class="row js-postFooterInfo">
                                                                                                                          <div class="col u-xs-size12of12 u-sm-size6of12">
                                                                                                                            <li class="card card-user">
                                                                                                                              <div class="u-floatRight">
                                                                                                                                <span class="followState js-followState buttonSet-inner" data-user-id="de4ec8fdb6c4">
                                                                                                                                  <button class="button button--small u-noUserSelect button--withChrome button--withHover button--unblock js-unblockButton" data-action="sign-in-prompt" data-sign-in-action="toggle-block-user" data-requires-token="true" data-action-source="footer_card">
                                                                                                                                    <span class="button-label  button-defaultState">Blocked</span>
                                                                                                                                    <span class="button-label button-hoverState">Unblock</span>
                                                                                                                                  </button>
                                                                                                                                  <button class="button button--primary button--small u-noUserSelect button--withChrome button--follow js-followButton" data-action="sign-in-prompt" data-sign-in-action="toggle-subscribe-user" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/user/de4ec8fdb6c4" data-action-source="footer_card_follow">
                                                                                                                                    <span class="button-label  button-defaultState js-buttonLabel">Follow</span>
                                                                                                                                    <span class="button-label button-activeState">Following</span>
                                                                                                                                  </button>
                                                                                                                                </span>
                                                                                                                              </div>
                                                                                                                              <div class="card-imageWrapper ">
                                                                                                                                <a class="link avatar"  href="https://medium.com/@joaquimadraz?source=footer_card" title="Go to the profile of Joaquim Adráz" aria-label="Go to the profile of Joaquim Adráz" data-action-source="footer_card" data-user-id="de4ec8fdb6c4" dir="auto">
                                                                                                                                  <img src="https://cdn-images-1.medium.com/fit/c/60/60/1*S4fZT4hlC9umSNsb40WP4g.jpeg" class="avatar-image avatar-image--small" alt="Go to the profile of Joaquim Adráz">
                                                                                                                                  </a>
                                                                                                                                </div>
                                                                                                                                <div class="card-content">
                                                                                                                                  <h3 class="card-name">
                                                                                                                                    <a class="link link--primary"  href="https://medium.com/@joaquimadraz" property="cc:attributionName" title="Go to the profile of Joaquim Adráz" aria-label="Go to the profile of Joaquim Adráz" rel="author cc:attributionUrl" data-user-id="de4ec8fdb6c4" dir="auto">Joaquim Adráz</a>
                                                                                                                                  </h3>
                                                                                                                                  <p class="card-description">software writer <a href="http://twitter.com/linkedcare" target="_blank" title="Twitter profile for @linkedcare">@linkedcare</a>. Lisbon, Portugal.</p>
                                                                                                                                </div>
                                                                                                                              </li>
                                                                                                                            </div>
                                                                                                                            <div class="col u-xs-size12of12 u-sm-size6of12 postFooter-collectionCard">
                                                                                                                              <li class="card card-collection">
                                                                                                                                <div class="u-floatRight">
                                                                                                                                  <button class="button button--primary button--small u-noUserSelect button--withChrome button--followCollection js-followCollectionButton" data-action="sign-in-prompt" data-sign-in-action="toggle-subscribe-collection" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/collection/the-engineering-team/2a60ff1c9a80" data-action-source="footer_card_collection_follow">
                                                                                                                                    <span class="button-label  button-defaultState js-buttonLabel">Follow</span>
                                                                                                                                    <span class="button-label button-activeState">Following</span>
                                                                                                                                  </button>
                                                                                                                                </div>
                                                                                                                                <div class="card-imageWrapper ">
                                                                                                                                  <div class="card-imageWrapper ">
                                                                                                                                    <a class="link avatar avatar--roundedRectangle"  href="https://medium.com/the-engineering-team?source=footer_card" title="Go to The linkedcare Engineering team" aria-label="Go to The linkedcare Engineering team" data-action-source="footer_card">
                                                                                                                                      <img src="https://cdn-images-1.medium.com/fit/c/60/60/1*HzRE96Rjos_PSSmLTwI62A.jpeg" class="avatar-image u-xs-size60x60" alt="The linkedcare Engineering team">
                                                                                                                                      </a>
                                                                                                                                    </div>
                                                                                                                                  </div>
                                                                                                                                  <div class="card-content">
                                                                                                                                    <h3 class="card-name">
                                                                                                                                      <a class="link link--primary"  href="https://medium.com/the-engineering-team?source=footer_card" title="Go to The linkedcare Engineering team" aria-label="Go to The linkedcare Engineering team" rel="collection" data-action-source="footer_card">The linkedcare Engineering team</a>
                                                                                                                                    </h3>
                                                                                                                                    <p class="card-description">Rants from our team members</p>
                                                                                                                                    <div class="buttonSet">
                                                                                                                                    </div>
                                                                                                                                  </div>
                                                                                                                                </li>
                                                                                                                              </div>
                                                                                                                            </div>
                                                                                                                          </div>
                                                                                                                          <div class="responsesWrapper supplementalPostContent js-responsesWrapper">
                                                                                                                          </div>
                                                                                                                          <div class="post-footer supplementalPostContent js-readNext">
                                                                                                                          </div>
                                                                                                                        </footer>
                                                                                                                      </article>
                                                                                                                      <div class="promoCardWrapper js-promoCardWrapper">
                                                                                                                        <div class="promoCard">
                                                                                                                          <button class="button button--chromeless button--close"  data-action="popup-dismiss">&times;</button>
                                                                                                                          <div class="promoCard-header">Don’t miss Joaquim Adráz’s next story</div>
                                                                                                                          <div class="u-floatRight">
                                                                                                                            <span class="followState js-followState buttonSet-inner" data-user-id="de4ec8fdb6c4">
                                                                                                                              <button class="button u-noUserSelect button--withChrome button--withHover button--unblock js-unblockButton" data-action="sign-in-prompt" data-sign-in-action="toggle-block-user" data-requires-token="true" data-action-source="user_follow_popup">
                                                                                                                                <span class="button-label  button-defaultState">Blocked</span>
                                                                                                                                <span class="button-label button-hoverState">Unblock</span>
                                                                                                                              </button>
                                                                                                                              <button class="button button--primary u-noUserSelect button--withChrome button--follow js-followButton" data-action="sign-in-prompt" data-sign-in-action="toggle-subscribe-user" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/user/de4ec8fdb6c4" data-action-source="user_follow_popup_follow">
                                                                                                                                <span class="button-label  button-defaultState js-buttonLabel">Follow</span>
                                                                                                                                <span class="button-label button-activeState">Following</span>
                                                                                                                              </button>
                                                                                                                            </span>
                                                                                                                          </div>
                                                                                                                          <div class="avatar">
                                                                                                                            <img src="https://cdn-images-1.medium.com/fit/c/40/40/1*S4fZT4hlC9umSNsb40WP4g.jpeg" class="avatar-image avatar-image--smaller" alt="Joaquim Adráz">
                                                                                                                              <span class="avatar-text">Joaquim Adráz</span>
                                                                                                                            </div>
                                                                                                                          </div>
                                                                                                                        </div>
                                                                                                                      </div>
                                                                                                                    </div>
                                                                                                                  </div>
                                                                                                                  <div class="loadingBar">
                                                                                                                  </div>

                                                                                                                </body>
                                                                                                              </html>
