

# fluent:service

    root@622b541c3c97:/# ulimit -a
    core file size          (blocks, -c) 0
    data seg size           (kbytes, -d) unlimited
    scheduling priority             (-e) 0
    file size               (blocks, -f) unlimited
    pending signals                 (-i) 7898
    max locked memory       (kbytes, -l) 64
    max memory size         (kbytes, -m) unlimited
    open files                      (-n) 1048576      # !
    pipe size            (512 bytes, -p) 8
    POSIX message queues     (bytes, -q) 819200
    real-time priority              (-r) 0
    stack size              (kbytes, -s) 8192
    cpu time               (seconds, -t) unlimited
    max user processes              (-u) 1048576      # !
    virtual memory          (kbytes, -v) unlimited
    file locks                      (-x) unlimited

    root@622b541c3c97:/# sysctl -a | grep file
    fs.file-max = 202089
    fs.file-nr = 224	0	202089

    # sysctl -w fs.file-max=100000


    The upper limit on fs.file-max is recorded in fs.nr_open. For example, (again) on Ubuntu 10.04:

    $ sysctl -n fs.nr_open
    1048576

You can tweak even more but

https://klaver.it/linux/sysctl.conf

1. know what you are doing and don't change any parameter unless you understan what it does.
2. don't overoptimize; most of these parameters have sane defaults and once you are optimizing for something you might be trading it off with something else.

instead find the inflection point and scale up from that point.

# you may want to give more ports to connections

net.ipv4.ip_local_port_range = 10000 65535
net.ipv4.ip_local_port_range = 32768 61000 #default
net.ipv4.ping_group_range = 1	0
